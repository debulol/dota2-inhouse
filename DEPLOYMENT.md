# éƒ¨ç½²æŒ‡å—

æœ¬æŒ‡å—å°†å¸®åŠ©ä½ å®Œæ•´éƒ¨ç½²å¤§è±¡å…¬ä¼š Dota2 å†…æˆ˜ç³»ç»Ÿã€‚

## å‰ç½®è¦æ±‚

- Node.js 18+ å’Œ npm
- Git
- Supabase è´¦å·
- Vercel è´¦å·ï¼ˆæˆ–å…¶ä»–æ‰˜ç®¡å¹³å°ï¼‰

## ç¬¬ä¸€æ­¥ï¼šè®¾ç½® Supabase æ•°æ®åº“

### 1.1 åˆ›å»º Supabase é¡¹ç›®

1. è®¿é—® [Supabase](https://supabase.com) å¹¶ç™»å½•
2. ç‚¹å‡» "New Project" åˆ›å»ºæ–°é¡¹ç›®
3. å¡«å†™é¡¹ç›®ä¿¡æ¯ï¼š
   - Name: dota2-inhouseï¼ˆæˆ–è‡ªå®šä¹‰ï¼‰
   - Database Password: è®¾ç½®ä¸€ä¸ªå¼ºå¯†ç 
   - Region: é€‰æ‹©ç¦»ä½ æœ€è¿‘çš„åŒºåŸŸï¼ˆå»ºè®®é€‰æ‹©æ–°åŠ å¡ï¼‰
4. ç­‰å¾…é¡¹ç›®åˆå§‹åŒ–å®Œæˆï¼ˆçº¦2åˆ†é’Ÿï¼‰

### 1.2 æ‰§è¡Œæ•°æ®åº“è„šæœ¬

1. è¿›å…¥ Supabase é¡¹ç›®çš„ SQL Editor
2. æ‰“å¼€ `supabase/migrations/001_initial_schema.sql`
3. å¤åˆ¶å…¨éƒ¨å†…å®¹åˆ° SQL Editor
4. ç‚¹å‡» "Run" æ‰§è¡Œè„šæœ¬
5. ç¡®è®¤æ‰€æœ‰è¡¨å’Œå‡½æ•°éƒ½åˆ›å»ºæˆåŠŸ

### 1.3 ä¿®æ”¹ç©å®¶åˆå§‹æ•°æ®

1. åœ¨ SQL Editor ä¸­æ‰¾åˆ° `INSERT INTO players` éƒ¨åˆ†
2. ä¿®æ”¹ä¸ºä½ çš„å®é™…ç©å®¶æ•°æ®ï¼š
   ```sql
   INSERT INTO players (username, avatar_url, positions, favorite_heroes, total_wins, total_losses) VALUES
   ('ç©å®¶1', 'å¤´åƒURL', ARRAY['Carry'], ARRAY['antimage', 'juggernaut'], 10, 5),
   ('ç©å®¶2', 'å¤´åƒURL', ARRAY['Support'], ARRAY['crystal_maiden', 'lion'], 8, 7),
   -- ... ç»§ç»­æ·»åŠ ä½ çš„ç©å®¶
   ```
3. ä½ å¯ä»¥ä½¿ç”¨ [DiceBear](https://api.dicebear.com/7.x/avataaars/svg?seed=xxx) ç”Ÿæˆå¤´åƒ
4. æ‰§è¡Œä¿®æ”¹åçš„ INSERT è¯­å¥

### 1.4 è·å– API å¯†é’¥

1. åœ¨ Supabase é¡¹ç›®è®¾ç½®ä¸­ï¼Œè¿›å…¥ "API" é¡µé¢
2. å¤åˆ¶ä»¥ä¸‹ä¿¡æ¯ï¼š
   - Project URL (ç±»ä¼¼: `https://xxxxx.supabase.co`)
   - anon public key (ä¸€é•¿ä¸²å­—ç¬¦)
3. ä¿å­˜è¿™äº›ä¿¡æ¯ï¼Œç¨åéœ€è¦ç”¨åˆ°

## ç¬¬äºŒæ­¥ï¼šæœ¬åœ°å¼€å‘æµ‹è¯•

### 2.1 å…‹éš†æˆ–ä¸‹è½½é¡¹ç›®

å¦‚æœå·²ç»æœ‰ä»£ç æ–‡ä»¶ï¼š
```bash
# è¿›å…¥é¡¹ç›®ç›®å½•
cd dota2-inhouse

# å®‰è£…ä¾èµ–
npm install
```

### 2.2 é…ç½®ç¯å¢ƒå˜é‡

1. å¤åˆ¶ `.env.example` ä¸º `.env`ï¼š
   ```bash
   cp .env.example .env
   ```

2. ç¼–è¾‘ `.env` æ–‡ä»¶ï¼Œå¡«å…¥ä½ çš„ Supabase ä¿¡æ¯ï¼š
   ```
   VITE_SUPABASE_URL=https://xxxxx.supabase.co
   VITE_SUPABASE_ANON_KEY=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
   ```

### 2.3 å¯åŠ¨å¼€å‘æœåŠ¡å™¨

```bash
npm run dev
```

è®¿é—® `http://localhost:5173` æµ‹è¯•åŠŸèƒ½ã€‚

## ç¬¬ä¸‰æ­¥ï¼šéƒ¨ç½²åˆ° Vercel

### 3.1 å‡†å¤‡ Git ä»“åº“

1. åœ¨ GitHub åˆ›å»ºæ–°ä»“åº“
2. æ¨é€ä»£ç ï¼š
   ```bash
   git init
   git add .
   git commit -m "Initial commit"
   git remote add origin https://github.com/your-username/dota2-inhouse.git
   git push -u origin main
   ```

### 3.2 åœ¨ Vercel éƒ¨ç½²

1. è®¿é—® [Vercel](https://vercel.com) å¹¶ç™»å½•
2. ç‚¹å‡» "New Project"
3. å¯¼å…¥ä½ çš„ GitHub ä»“åº“
4. é…ç½®é¡¹ç›®ï¼š
   - Framework Preset: Vite
   - Root Directory: ./
   - Build Command: `npm run build`
   - Output Directory: `dist`
5. æ·»åŠ ç¯å¢ƒå˜é‡ï¼š
   - `VITE_SUPABASE_URL`: ä½ çš„ Supabase URL
   - `VITE_SUPABASE_ANON_KEY`: ä½ çš„ Supabase Key
6. ç‚¹å‡» "Deploy"
7. ç­‰å¾…éƒ¨ç½²å®Œæˆï¼ˆçº¦1-2åˆ†é’Ÿï¼‰

### 3.3 è·å–éƒ¨ç½²é“¾æ¥

éƒ¨ç½²æˆåŠŸåï¼ŒVercel ä¼šæä¾›ä¸€ä¸ªåŸŸåï¼Œå¦‚ï¼š
- `https://dota2-inhouse.vercel.app`

ä½ ä¹Ÿå¯ä»¥ç»‘å®šè‡ªå®šä¹‰åŸŸåã€‚

## ç¬¬å››æ­¥ï¼šæ·»åŠ è‹±é›„å¤´åƒèµ„æº

### 4.1 ä¸‹è½½è‹±é›„å¤´åƒ

1. è®¿é—® [dota2-minimap-hero-sprites](https://github.com/bontscho/dota2-minimap-hero-sprites)
2. ä¸‹è½½è‹±é›„å¤´åƒå›¾ç‰‡
3. å°†å›¾ç‰‡æ”¾åˆ° `public/heroes/` ç›®å½•
4. ç¡®ä¿æ–‡ä»¶åä¸ `src/data/heroes.js` ä¸­çš„è‹±é›„ ID å¯¹åº”

### 4.2 é‡æ–°éƒ¨ç½²

```bash
git add public/heroes/
git commit -m "Add hero icons"
git push
```

Vercel ä¼šè‡ªåŠ¨é‡æ–°éƒ¨ç½²ã€‚

## ç¬¬äº”æ­¥ï¼šæµ‹è¯•å®Œæ•´æµç¨‹

1. è®¿é—®ä½ çš„ç½‘ç«™
2. é€‰æ‹©ä¸€ä¸ªç©å®¶è§’è‰²
3. åˆ›å»ºæˆ¿é—´
4. ç”¨å¦ä¸€ä¸ªè®¾å¤‡/æµè§ˆå™¨åŠ å…¥æˆ¿é—´
5. æµ‹è¯• Roll ç‚¹ã€é€‰äººã€æ¸¸æˆç»“æŸç­‰å®Œæ•´æµç¨‹
6. æ£€æŸ¥æˆ˜ç»©æ˜¯å¦æ­£ç¡®æ›´æ–°

## å¸¸è§é—®é¢˜

### Q1: æ— æ³•è¿æ¥åˆ° Supabase

**è§£å†³æ–¹æ¡ˆ**ï¼š
- æ£€æŸ¥ `.env` æ–‡ä»¶ä¸­çš„ URL å’Œ Key æ˜¯å¦æ­£ç¡®
- ç¡®è®¤ Supabase é¡¹ç›®æ˜¯å¦æ­£å¸¸è¿è¡Œ
- æ£€æŸ¥ç½‘ç»œæ˜¯å¦å¯ä»¥è®¿é—® Supabase

### Q2: ç©å®¶æ— æ³•åŠ å…¥æˆ¿é—´

**è§£å†³æ–¹æ¡ˆ**ï¼š
- æ£€æŸ¥æ•°æ®åº“å‡½æ•°æ˜¯å¦æ­£ç¡®åˆ›å»º
- æŸ¥çœ‹æµè§ˆå™¨æ§åˆ¶å°æ˜¯å¦æœ‰é”™è¯¯
- ç¡®è®¤æˆ¿é—´çŠ¶æ€æ˜¯å¦æ­£ç¡®

### Q3: æˆ˜ç»©æœªæ›´æ–°

**è§£å†³æ–¹æ¡ˆ**ï¼š
- æ£€æŸ¥ `finish_match` å‡½æ•°æ˜¯å¦æ­£ç¡®æ‰§è¡Œ
- ç¡®è®¤æ¸¸æˆå¼€å§‹æ—¶é˜Ÿä¼éƒ½æ˜¯5äºº
- æŸ¥çœ‹ Supabase æ—¥å¿—

### Q4: å®æ—¶æ›´æ–°ä¸å·¥ä½œ

**è§£å†³æ–¹æ¡ˆ**ï¼š
- ç¡®è®¤ Supabase Realtime åŠŸèƒ½å·²å¯ç”¨
- æ£€æŸ¥ç½‘ç»œè¿æ¥
- å°è¯•åˆ·æ–°é¡µé¢

## ç»´æŠ¤å’Œæ›´æ–°

### ä¿®æ”¹ç©å®¶æˆ˜ç»©

ç›´æ¥åœ¨ Supabase æ§åˆ¶å°çš„ `players` è¡¨ä¸­ä¿®æ”¹ `total_wins` å’Œ `total_losses` å­—æ®µã€‚

### æ·»åŠ æ–°ç©å®¶

åœ¨ Supabase æ§åˆ¶å°çš„ `players` è¡¨ä¸­æ’å…¥æ–°è®°å½•ã€‚

### æ¸…ç†è¿‡æœŸæˆ¿é—´

å®šæœŸæ‰§è¡Œï¼š
```sql
SELECT cleanup_expired_rooms();
```

æˆ–è®¾ç½® Supabase Edge Function å®šæ—¶ä»»åŠ¡ã€‚

### æ•°æ®å¤‡ä»½

å»ºè®®å®šæœŸåœ¨ Supabase æ§åˆ¶å°å¯¼å‡ºæ•°æ®å¤‡ä»½ã€‚

## æŠ€æœ¯æ”¯æŒ

å¦‚é‡åˆ°é—®é¢˜ï¼š
1. æŸ¥çœ‹æµè§ˆå™¨æ§åˆ¶å°é”™è¯¯
2. æŸ¥çœ‹ Supabase æ—¥å¿—
3. æ£€æŸ¥ç½‘ç»œè¯·æ±‚

## åç»­ä¼˜åŒ–å»ºè®®

1. **æ€§èƒ½ä¼˜åŒ–**ï¼šæ·»åŠ æ•°æ®ç¼“å­˜ã€å›¾ç‰‡æ‡’åŠ è½½
2. **åŠŸèƒ½æ‰©å±•**ï¼š
   - æ·»åŠ èŠå¤©åŠŸèƒ½
   - æ¥å…¥ Dota2 GSI è‡ªåŠ¨è¯†åˆ«æ¯”èµ›ç»“æœ
   - æ·»åŠ è‹±é›„èƒœç‡ç»Ÿè®¡
   - æ·»åŠ èµ›å­£åˆ¶åº¦
3. **UIæ”¹è¿›**ï¼šæ·»åŠ æ›´å¤šåŠ¨ç”»æ•ˆæœã€å“åº”å¼ä¼˜åŒ–

ç¥ä½ ä½¿ç”¨æ„‰å¿«ï¼ğŸ®
